<!DOCTYPE html>
<html>
<head>
    <title>Image Loading Test</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        .log { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 4px; }
        .error { background: #ffe0e0; }
        .success { background: #e0ffe0; }
        #cardImage { border: 2px solid #ccc; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>Card Image Service Test</h1>
    <div id="logs"></div>
    <img id="cardImage" style="width: 146px; height: 204px;" />

    <script type="module">
        const logDiv = document.getElementById('logs');
        const imgEl = document.getElementById('cardImage');

        function log(message, type = 'log') {
            const div = document.createElement('div');
            div.className = `log ${type}`;
            div.textContent = `[${new Date().toISOString().substr(11,8)}] ${message}`;
            logDiv.appendChild(div);
            console.log(message);
        }

        log('Starting test...');

        try {
            log('Attempting to import CardImageService...');

            import('/src/services/cardImageService.mjs')
                .then(module => {
                    log('✓ Module loaded successfully', 'success');
                    log(`CardImageService = ${module.CardImageService}`);

                    const testCard = 'Lightning Bolt';
                    log(`Fetching image for: ${testCard}`);

                    return module.CardImageService.getCardImageUrl(testCard, 'small');
                })
                .then(imageUrl => {
                    log(`✓ Got image URL: ${imageUrl}`, 'success');
                    imgEl.src = imageUrl;
                    imgEl.onload = () => log('✓ Image loaded successfully!', 'success');
                    imgEl.onerror = (e) => log(`✗ Failed to load image: ${e}`, 'error');
                })
                .catch(error => {
                    log(`✗ Error: ${error.message}`, 'error');
                    log(`Stack: ${error.stack}`, 'error');
                });
        } catch (error) {
            log(`✗ Caught error: ${error.message}`, 'error');
        }
    </script>
</body>
</html>
